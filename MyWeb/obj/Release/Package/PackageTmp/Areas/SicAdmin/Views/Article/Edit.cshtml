@model MyWeb.Models.Article

@{
    ViewBag.Title = "Edit";
    Layout = "~/Areas/SicAdmin/Views/Shared/_AdminLayout.cshtml";
}
@{string img = "0";
  string qr = Request.QueryString["img"];
     img= HttpUtility.UrlDecode(Request.QueryString["img"], System.Text.Encoding.BigEndianUnicode);
  int id = ViewBag.id;
  }
<script src="~/Scripts/jquery-2.1.1.min.js"></script>
<script type="text/javascript"> 
    var s = "@img";
    $(function () {
            var dd = $("#r").text();
            //alert(s);
        if (s == "") {
            //alert("if");
            $("#upLoadImageShow").attr("src", dd);
        }
            //修改后返回显示
        else {
            //alert("else");
            $("#upLoadImageShow").attr("src","@img");
            $("#r").text("@img");
        }
            //$("#upLoadImageShow").attr("src", d);
        }
   )
</script>  
<h2>Edit</h2>

<p class="mb15"> 
          <img src="" id="upLoadImageShow" width="183" height="132" />
          <br />
          <a id="system" style="cursor: pointer;" onclick="selectSettingType()">选择上传图片</a>
      </p>
      @*<p class="mb15">*@
<div id="upload" class="cb mt10" ">

                <div id="upload_title" class="mt10">
                    <h4>选择本地图片上传</h4>
                    <span id="errorInfoSpan" class="red"></span>
                </div>

               @* <iframe name="hd" style="display: none;"></iframe>*@
                <form id="fileForm" method="post" action="@Url.Content("/Article/EditImageUpLoad/"+id)" enctype="multipart/form-data" >
                    <input type="file" name="upImage"  class="mt10"  size="50" />
                    <input id="btnUpload" type="submit" value="上传" />
                    <span class="gray">图片格式 jpg/gif 小于1M</span><br />
                </form>
    
    <iframe id="tar" name="tar" style="display:none">
    </iframe>
      </div>


@using (Html.BeginForm()) {
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Article</legend>

        @Html.HiddenFor(model => model.id)

        <div class="editor-label">
            @Html.LabelFor(model => model.Title)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Title)
            @Html.ValidationMessageFor(model => model.Title)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ArticleContent)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(s=>s.ArticleContent,new{@id="editor_id",@style="width:700px;height:300px;"})
            @Html.ValidationMessageFor(model => model.ArticleContent)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.CoverImage)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.CoverImage, new {@id="r"})
            @Html.ValidationMessageFor(model => model.CoverImage)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.PublisherID)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.PublisherID)
            @Html.ValidationMessageFor(model => model.PublisherID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.CreatDate)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CreatDate)
            @Html.ValidationMessageFor(model => model.CreatDate)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ChangeDate)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.ChangeDate)
            @Html.ValidationMessageFor(model => model.ChangeDate)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Source)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Source)
            @Html.ValidationMessageFor(model => model.Source)
        </div>

         <div class="editor-label">
            @Html.LabelFor(model => model.SourceUrl)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.SourceUrl)
            @Html.ValidationMessageFor(model => model.SourceUrl)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ClickTimes)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.ClickTimes)
            @Html.ValidationMessageFor(model => model.ClickTimes)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.TypeID, "ArticleType")
        </div>
        <div class="editor-field">
            @Html.DropDownList("TypeID", String.Empty)
            @Html.ValidationMessageFor(model => model.TypeID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Label)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Label)
            @Html.ValidationMessageFor(model => model.Label)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.AgreeTimes)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.AgreeTimes)
            @Html.ValidationMessageFor(model => model.AgreeTimes)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Isdel)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Isdel)
            @Html.ValidationMessageFor(model => model.Isdel)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Equipment)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Equipment)
            @Html.ValidationMessageFor(model => model.Equipment)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Sort)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Sort)
            @Html.ValidationMessageFor(model => model.Sort)
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
